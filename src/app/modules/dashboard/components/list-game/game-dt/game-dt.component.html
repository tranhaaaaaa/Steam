
<div class="product-page-container">

  <!-- <div class="breadcrumbs">
    <a href="#">Tất cả trò chơi</a> > <a href="#">Hành động</a> > <a href="#">Loạt sản phẩm NEOWIZ</a> > <span>Lies of P</span>
  </div> -->
  <h1 class="game-title">{{ gameDetail.Title }}</h1>

  <div class="main-content-grid">

    <div class="left-column">
 <div class="media-carousel" *ngIf="selectedMedia">
        <div class="main-media"> 
          <img [src]="selectedMedia.MediaURL" alt="Main game media" *ngIf="selectedMedia.MediaType === 'image'">
      <video *ngIf="selectedMedia.MediaType === 'video'" controls>
            <source [src]="selectedMedia.MediaURL" type="video/mp4">
            Your browser does not support the video tag.
          </video>



        </div>
        <div class="thumbnail-strip">
          <div *ngFor="let media of gameDetail.Media" class="thumbnail" 
               [class.active]="media.Id === selectedMedia.Id"
               (click)="selectMedia(media)">
            <img [src]="media.MediaURL" alt="Game thumbnail" *ngIf="media.MediaType === 'image'">
            <div class="play-icon" *ngIf="media.MediaType === 'video'" (click)="selectMedia(media)"></div>
          </div>
        </div>
      </div>
      <div class="action-buttons-container">
        <button class="action-btn green" (click)="onAddwishlist()">Thêm vào danh sách yêu thích</button>
        <button class="action-btn">Theo dõi</button>
        <button class="action-btn">Phớt lờ</button>
      </div>
 

<!-- app/modules/.../purchase-section.component.html -->
<div class="purchase-section">
  <!-- Tiêu đề -->
  <h2 *ngIf="gameDetail.Price > 0">Mua {{ gameDetail.Title }}</h2>
  <h2 *ngIf="gameDetail.Price === 0">Tải xuống: {{ gameDetail.Title }}</h2>

  <div class="purchase-box">
    <!-- Badge giảm giá: chỉ hiện khi có discount -->
    <div class="discount-badge" *ngIf="gameDetail.Discounts.length > 0">
      -{{ gameDetail.Discounts[0].value | number }}%
    </div>

    <!-- Khu vực giá: chỉ hiện khi có giá bán -->
    <div class="price-info" *ngIf="gameDetail.Price > 0">
      <!-- Giá gốc: chỉ hiện khi có giảm giá -->
      <div class="original-price" *ngIf="gameDetail.Discounts.length > 0">
        {{ gameDetail.Price | number }} VND
      </div>

      <!-- Giá cuối cùng -->
      <div class="final-price" *ngIf="gameDetail.Discounts.length > 0">
        {{
          (gameDetail.Price * (1 - gameDetail.Discounts[0].value / 100))
            | currency:'VND'
        }}
      </div>
      <div class="final-price" *ngIf="gameDetail.Discounts.length === 0">
        {{ gameDetail.Price | currency:'VND' }}
      </div>
    </div>

    <!-- Nút hành động -->
    <button *ngIf="gameDetail.Price > 0"
            class="add-to-cart-btn"
            (click)="addToCart(gameDetail.Id)">
      Thêm vào giỏ
    </button>
    <button *ngIf="gameDetail.Price === 0"
            class="add-to-cart-btn"
            (click)="download(gameDetail)">
      Tải xuống
    </button>
  </div>
</div>

 
<div class="about-section">
        <h2>VỀ TRÒ CHƠI NÀY</h2>
        <p>{{ gameDetail.Description }}</p>
      </div>
      <div class="reviews-section">
  <h2>ĐÁNH GIÁ SẢN PHẨM</h2>

  <!-- Static review items -->
<div class="review-item" *ngFor="let review of listReview">
  <div class="review-header">
    <img 
      [src]="review.profilePicture || 'assets/default-avatar.png'" 
      alt="Avatar" 
      style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;"
    >
    <p class="review-author" style="color:white; margin: 0;">{{ review.userName }}</p>
  </div>

  <p class="review-text" style="color:white">{{ review.Comment }}</p>

  <!-- Ngày tạo -->
  <div>
    <p class="review-text" style="color:rgb(219, 52, 52)">
      {{ review.CreatedAt | date: 'HH:mm dd/MM/yyyy' }}
    </p>
  </div>
</div>


  <div class="review-input-section">
    <h3>Để lại đánh giá của bạn</h3>
    <form>
      <div class="stars">
        <span *ngFor="let star of [1, 2, 3, 4, 5]" class="star" style="color:red" [class.filled]="star <= 5"></span>
      </div>
      <textarea placeholder="Nhập đánh giá của bạn" name="hihi" rows="4" [(ngModel)]="comment"></textarea>
      <button type="submit" class="submit-review-btn" (click)="sendComment()">Gửi đánh giá</button>
    </form>
  </div>
</div>


    </div>


    <div class="right-column">
      <img [src]="gameDetail.CoverImagePath" alt="Game capsule" class="capsule-image">
      <p class="game-description-right">{{ gameDetail.Description }}</p>
      <div class="review-summary">
        <p><strong>ĐÁNH GIÁ GẦN ĐÂY:</strong> <span class="positive">500</span> (200)</p>
        <p><strong>ĐÁNH GIÁ CHUNG:</strong> <span class="positive">1000</span> (440)</p>
      </div>
      <div class="release-info">
        <p><strong>NGÀY PHÁT HÀNH:</strong> {{ gameDetail.CreatedAt | date }}</p>
        <!-- <p><strong>NHÀ PHÁT TRIỂN:</strong> <a href="#">{{ gameDetail.developer }}</a></p>
        <p><strong>NHÀ PHÁT HÀNH:</strong> <a href="#">{{ game.publisher }}</a></p> -->
      </div>
      <div class="tags-container">
        <a *ngFor="let tag of gameDetail.Tags"  class="tag">{{ tag.TagName  }}</a>
        <a  class="tag plus-tag">+</a>
      </div>
    </div>
  </div>
</div>

<!-- NEW: DIALOG THÊM VÀO GIỎ HÀNG -->
<div *ngIf="showAddToCartDialog" class="dialog-backdrop" (click)="closeAddToCartDialog()">
  <div class="dialog-panel" (click)="$event.stopPropagation()">
    <h3 class="dialog-title">Đã thêm vào giỏ hàng</h3>
    <p class="dialog-content">Sản phẩm đã được thêm vào giỏ hàng của bạn.</p>
    <div class="dialog-actions">
      <button class="dialog-btn secondary" (click)="continueShopping()">Tiếp tục mua sắm</button>
      <button class="dialog-btn primary" (click)="viewCart()">Xem giỏ hàng</button>
    </div>
  </div>
</div>